# TeslaMate Grafana 看板集合

本目录包含 TeslaMate 项目的所有 Grafana 看板文件，按功能进行分类整理，共计 **23 个看板**。

## 目录结构

```
teslamate-grafana/
├── README.md                    # 本文档
├── core/                        # 核心概览类看板 (4个)
├── battery-charging/            # 电池与充电类看板 (5个)
├── driving/                     # 驾驶与行程类看板 (5个)
├── locations/                   # 位置与地点类看板 (2个)
├── system/                      # 系统与维护类看板 (3个)
├── internal/                    # 内部看板 (3个)
└── reports/                     # 报告看板 (1个)
```

---

## 核心概览类 (`core/`)

用于展示车辆的整体状态和综合统计信息。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `overview.json` | **Overview** | 车辆高层概览看板，显示当前电池电量、续航里程、车辆状态、位置信息等核心指标，是日常查看的主要入口 |
| `statistics.json` | **Statistics** | 综合统计数据看板，汇总驾驶、充电、能耗等各类统计指标 |
| `timeline.json` | **Timeline** | 车辆活动时间线，以时间轴形式展示车辆的各种状态变化（驾驶、充电、停放、睡眠等） |
| `states.json` | **States** | 车辆状态分布看板，展示车辆在不同状态（在线、睡眠、驾驶、充电）的时间分布 |

### 主要指标
- 当前电池电量百分比
- 预估续航里程
- 车辆在线/离线状态
- 总驾驶里程
- 状态时间分布统计

---

## 电池与充电类 (`battery-charging/`)

专注于电池健康状况和充电相关数据分析。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `battery-health.json` | **Battery Health** | 电池健康状态分析，跟踪电池容量衰减情况，估算当前可用容量与新车容量的对比 |
| `charge-level.json` | **Charge Level** | 电量等级历史记录，展示电池电量随时间的变化趋势，支持移动平均和百分位分析 |
| `charges.json` | **Charges** | 充电记录列表，显示所有充电会话的详细信息，包括充电地点、充电量、费用等 |
| `charging-stats.json` | **Charging Stats** | 充电统计数据分析，汇总充电频率、充电量、充电成本等统计指标 |
| `projected-range.json` | **Projected Range** | 预测续航里程分析，基于历史数据预测实际可行驶里程 |

### 主要指标
- 电池健康度 (SOH)
- 可用电池容量 (kWh)
- 充电效率
- 单次充电量统计
- 充电费用统计
- 充电地点分布
- 理想续航 vs 实际续航对比

---

## 驾驶与行程类 (`driving/`)

记录和分析驾驶行为和行程数据。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `drives.json` | **Drives** | 驾驶记录列表，显示所有驾驶行程的详细信息，包括起止地点、距离、耗时、能耗等 |
| `drive-stats.json` | **Drive Stats** | 驾驶统计数据，汇总驾驶总里程、平均速度、能耗效率等指标 |
| `trip.json` | **Trip** | 行程规划与记录看板，支持多段行程组合分析，显示行程路线、海拔变化、电量消耗 |
| `mileage.json` | **Mileage** | 里程统计看板，追踪车辆总里程变化趋势 |
| `efficiency.json` | **Efficiency** | 能效分析看板，分析不同条件下的能耗效率（温度、速度、空调使用等因素） |

### 主要指标
- 单次行程距离和耗时
- 平均速度和最高速度
- 能耗效率 (Wh/km 或 Wh/mi)
- 总驾驶里程
- 驾驶时间统计
- 能耗与温度/速度的关系分析

---

## 位置与地点类 (`locations/`)

管理和展示车辆访问过的地点信息。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `locations.json` | **Locations** | 位置管理看板，展示所有地理围栏、访问过的地址、城市、州/省、国家的统计信息 |
| `visited.json` | **Visited** | 访问地点记录，以地图和列表形式展示车辆访问过的所有地点 |

### 主要指标
- 地理围栏数量
- 访问过的唯一地址数
- 城市/州/国家访问统计
- 最常访问的地点
- 最近访问的地点

---

## 系统与维护类 (`system/`)

监控系统状态和特殊数据分析。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `updates.json` | **Updates** | 软件更新记录，追踪车辆固件版本变更历史，显示更新时间间隔统计 |
| `vampire-drain.json` | **Vampire Drain** | 静置电量损耗分析（吸血鬼损耗），分析车辆停放时的电量流失情况，帮助优化停车策略 |
| `database-info.json` | **Database Information** | 数据库健康信息，显示 TeslaMate PostgreSQL 数据库的状态、大小、索引效率等维护信息 |

### 主要指标
- 当前固件版本
- 更新历史记录
- 更新间隔中位数
- 静置电量损耗率 (%/天)
- 数据库大小
- 索引健康状态
- 未关闭的驾驶/充电记录警告

---

## 内部看板 (`internal/`)

主要用于详情页面跳转和系统入口，通常不直接访问。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `home.json` | **Home** | 主页/入口看板，作为 Grafana 的默认首页 |
| `charge-details.json` | **Charge Details** | 单次充电详情页，从 Charges 看板跳转查看，显示充电曲线、功率变化等详细信息 |
| `drive-details.json` | **Drive Details** | 单次驾驶详情页，从 Drives 看板跳转查看，显示行程轨迹、速度曲线、能耗分析等 |

### 主要指标
- 充电功率曲线
- 充电过程中的电压/电流变化
- 驾驶轨迹地图
- 速度变化曲线
- 海拔变化曲线
- 实时能耗数据

---

## 报告看板 (`reports/`)

特定用途的报告生成看板。

| 文件名 | 看板标题 | 功能说明 |
|--------|---------|----------|
| `dutch-tax.json` | **Drives - Dutch tax** | 荷兰税务驾驶报告，用于生成符合荷兰税务要求的驾驶记录报告 |

---

## 使用说明

### 导入看板到 Grafana

1. 登录 Grafana 管理界面
2. 进入 **Dashboards** → **Import**
3. 上传对应的 JSON 文件或粘贴 JSON 内容
4. 选择数据源为 TeslaMate PostgreSQL 数据源
5. 点击 **Import** 完成导入

### 数据源要求

所有看板都需要连接到 TeslaMate 的 PostgreSQL 数据库，数据源 UID 应设置为 `TeslaMate`。

### 变量说明

大多数看板使用以下通用变量：

| 变量名 | 说明 |
|--------|------|
| `car_id` | 车辆 ID，支持多车选择 |
| `length_unit` | 长度单位（km/mi） |
| `preferred_range` | 首选续航显示模式 |
| `base_url` | TeslaMate Web 基础 URL |

---

## 相关链接

- [TeslaMate 官方文档](https://docs.teslamate.org/)
- [TeslaMate GitHub 仓库](https://github.com/teslamate-org/teslamate)
- [Grafana 官方文档](https://grafana.com/docs/)

---

## 文件统计

| 分类 | 文件数量 |
|------|----------|
| 核心概览类 | 4 |
| 电池与充电类 | 5 |
| 驾驶与行程类 | 5 |
| 位置与地点类 | 2 |
| 系统与维护类 | 3 |
| 内部看板 | 3 |
| 报告看板 | 1 |
| **总计** | **23** |
